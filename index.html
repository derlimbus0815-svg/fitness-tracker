<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fitness Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { overscroll-behavior: none; -webkit-overflow-scrolling: touch; margin: 0; padding: 0; }
        * { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const WEIGHT_KEYWORDS = ['Langhantel', 'Weighted', 'Bulgarian', 'Romanian'];
        const EXPLICIT_WEIGHT_EXERCISES = new Set(['Clean & Press', 'Calf Raises (Langhantel)', 'Goblet Squats']);

        const isWeightExercise = (name) => {
            if (EXPLICIT_WEIGHT_EXERCISES.has(name)) return true;
            return WEIGHT_KEYWORDS.some(kw => name.includes(kw));
        };

        const Play = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>;
        const Pause = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>;
        const RotateCcw = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>;
        const CheckCircle = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>;
        const Circle = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle></svg>;
        const TrendingUp = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>;
        const Calendar = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>;
        const Trophy = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path></svg>;
        const Zap = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>;
        const Target = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>;
        const X = ({className}) => <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;

        function FitnessTracker() {
            const [activeTab, setActiveTab] = useState('home');
            const [userLevel, setUserLevel] = useState(() => parseInt(localStorage.getItem('userLevel') || '1'));
            const [xp, setXp] = useState(() => parseInt(localStorage.getItem('xp') || '0'));
            const xpNeeded = 7;
            const [timerSeconds, setTimerSeconds] = useState(0);
            const [isTimerRunning, setIsTimerRunning] = useState(false);
            const [sessionCalories, setSessionCalories] = useState('');
            const [currentWeek, setCurrentWeek] = useState(() => parseInt(localStorage.getItem('currentWeek') || '1'));

            const [skillGoals, setSkillGoals] = useState(() => 
                JSON.parse(localStorage.getItem('skillGoals') || JSON.stringify({
                    'Muscle-up': { current: 0, target: 1, unit: 'Reps', milestone: 0 },
                    'Handstand': { current: 30, target: 60, unit: 'Sekunden', milestone: 30 },
                    'Pistol Squat': { current: 0, target: 12, unit: 'Reps/Bein', milestone: 0 },
                    'Front Lever': { current: 0, target: 10, unit: 'Sek (Full)', milestone: 0 },
                    'Back Squat': { current: 60, target: 120, unit: 'kg', milestone: 60 },
                    'Planche': { current: 0, target: 8, unit: 'Sek (Tuck)', milestone: 0 }
                }))
            );

            const baseWorkout = {
                'Montag': { duration: 60, calories: 450, exercises: [
                    { name: 'Handstand-Progression', xp: 20 },
                    { name: 'Dips - 4x8-15', xp: 15 },
                    { name: 'Langhantel Overhead Press - 3x6-8', xp: 15, needsWeight: true },
                    { name: 'Planche-Progression', xp: 15 },
                    { name: 'Goblet Squats - 3x12-15', xp: 12, needsWeight: true },
                    { name: 'Langhantel Curls - 3x10-12', xp: 10, needsWeight: true }
                ]},
                'Dienstag': { duration: 70, calories: 480, exercises: [
                    { name: 'Muscle-up-Progression', xp: 20 },
                    { name: 'Langhantel Rows - 4x8-10', xp: 15, needsWeight: true },
                    { name: 'Front-Lever-Progression', xp: 15 },
                    { name: 'Langhantel Deadlifts - 3x5', xp: 15, needsWeight: true },
                    { name: 'Good Mornings - 3x10-12', xp: 12 },
                    { name: 'Facepulls - 3x15', xp: 10 },
                    { name: 'Mobility Finisher - 10 Min', xp: 10 }
                ]},
                'Mittwoch': { duration: 45, calories: 200, exercises: [
                    { name: '30 Min Spaziergang/Cardio', xp: 15 },
                    { name: 'Yoga Flow - 15 Min', xp: 10 },
                    { name: 'Faszienrolle/Stretching', xp: 10 }
                ]},
                'Donnerstag': { duration: 65, calories: 550, exercises: [
                    { name: 'Langhantel Back Squats - 5x5', xp: 20, needsWeight: true },
                    { name: 'Bulgarian Split Squats - 3x8-10', xp: 15, needsWeight: true },
                    { name: 'Pistol-Squat-Progression', xp: 15 },
                    { name: 'Nordic Curls - 3x max', xp: 15 },
                    { name: 'Hanging Leg Raises - 4x10-15', xp: 10 },
                    { name: 'L-Sit-Progression', xp: 10 }
                ]},
                'Freitag': { duration: 70, calories: 500, exercises: [
                    { name: 'Muscle-up-Progression', xp: 20 },
                    { name: 'Clean & Press - 4x5', xp: 15, needsWeight: true },
                    { name: 'Weighted Push-ups - 3x8-12', xp: 15, needsWeight: true },
                    { name: 'Langhantel Hack Squats - 3x10-12', xp: 15, needsWeight: true },
                    { name: 'L-Sit-Progression', xp: 10 },
                    { name: 'Hollow Body Holds - 3x45s', xp: 10 },
                    { name: 'Handstand-Progression', xp: 15 }
                ]},
                'Samstag': { duration: 60, calories: 520, exercises: [
                    { name: 'Langhantel Front Squats - 4x8-10', xp: 20, needsWeight: true },
                    { name: 'Romanian Deadlifts - 4x8-10', xp: 18, needsWeight: true },
                    { name: 'Weighted Lunges - 3x10 pro Bein', xp: 15, needsWeight: true },
                    { name: 'Calf Raises (Langhantel) - 4x15-20', xp: 12, needsWeight: true },
                    { name: 'Human-Flag-Progression', xp: 15 },
                    { name: 'Core-Circuit - 10 Min', xp: 10 }
                ]},
                'Sonntag': { duration: 0, calories: 0, exercises: [{ name: 'Vollst√§ndige Regeneration', xp: 0 }]}
            };

            const workoutProgression = {
                1: baseWorkout,
                2: baseWorkout,
                3: {
                    ...baseWorkout,
                    'Dienstag': { ...baseWorkout.Dienstag, exercises: [
                        { name: 'Scapula Pull-ups - 3x10', xp: 15 },
                        { name: 'Langhantel Rows - 4x9-11', xp: 15, needsWeight: true },
                        { name: 'Front-Lever-Progression', xp: 15 },
                        { name: 'Langhantel Deadlifts - 3x5', xp: 15, needsWeight: true },
                        { name: 'Good Mornings - 3x12-14', xp: 12 },
                        { name: 'Facepulls - 3x15', xp: 10 },
                        { name: 'Mobility Finisher - 10 Min', xp: 10 }
                    ]}
                },
                4: {
                    ...baseWorkout,
                    'Dienstag': { ...baseWorkout.Dienstag, exercises: [
                        { name: 'Scapula Pull-ups - 3x10', xp: 15 },
                        { name: 'Langhantel Rows - 4x9-11', xp: 15, needsWeight: true },
                        { name: 'Front-Lever-Progression', xp: 15 },
                        { name: 'Langhantel Deadlifts - 3x5', xp: 15, needsWeight: true },
                        { name: 'Good Mornings - 3x12-14', xp: 12 },
                        { name: 'Facepulls - 3x15', xp: 10 },
                        { name: 'Mobility Finisher - 10 Min', xp: 10 }
                    ]},
                    'Montag': { ...baseWorkout.Montag, exercises: [
                        { name: 'Handstand-Progression', xp: 20 },
                        { name: 'Dips - 4x10-16', xp: 15 },
                        { name: 'Langhantel Overhead Press - 3x6-8', xp: 15, needsWeight: true },
                        { name: 'Frog Stand - 3x max hold', xp: 15 },
                        { name: 'Goblet Squats - 3x12-15', xp: 12, needsWeight: true },
                        { name: 'Langhantel Curls - 3x10-12', xp: 10, needsWeight: true }
                    ]}
                },
                5: {
                    ...baseWorkout,
                    'Dienstag': { ...baseWorkout.Dienstag, exercises: [
                        { name: 'Explosive Pull-ups - 4x5', xp: 20 },
                        { name: 'Langhantel Rows - 4x10-12', xp: 15, needsWeight: true },
                        { name: 'Front-Lever Tuck - 4x max hold', xp: 15 },
                        { name: 'Langhantel Deadlifts - 3x5', xp: 15, needsWeight: true },
                        { name: 'Good Mornings - 3x12-15', xp: 12 },
                        { name: 'Facepulls - 3x15', xp: 10 },
                        { name: 'Mobility Finisher - 10 Min', xp: 10 }
                    ]},
                    'Montag': { ...baseWorkout.Montag, exercises: [
                        { name: 'Handstand Shoulder Taps - 3x6', xp: 20 },
                        { name: 'Dips - 4x12-16', xp: 15 },
                        { name: 'Langhantel Overhead Press - 3x6-8', xp: 15, needsWeight: true },
                        { name: 'Planche Lean - 4x15s', xp: 15 },
                        { name: 'Goblet Squats - 3x15', xp: 12, needsWeight: true },
                        { name: 'Langhantel Curls - 3x12', xp: 10, needsWeight: true }
                    ]},
                    'Mittwoch': { ...baseWorkout.Mittwoch, exercises: [
                        { name: '30 Min Spaziergang/Cardio', xp: 15 },
                        { name: 'Hollow Body to Arch - 3x8', xp: 12 },
                        { name: 'Yoga Flow - 15 Min', xp: 10 },
                        { name: 'Faszienrolle/Stretching', xp: 10 }
                    ]}
                },
                6: {
                    ...baseWorkout,
                    'Dienstag': { ...baseWorkout.Dienstag, exercises: [
                        { name: 'Explosive Pull-ups - 4x6', xp: 20 },
                        { name: 'Band-assisted Muscle-up Negative - 3x3', xp: 20 },
                        { name: 'Langhantel Rows - 4x10-12', xp: 15, needsWeight: true },
                        { name: 'Front-Lever Tuck - 4x max hold', xp: 15 },
                        { name: 'Langhantel Deadlifts - 3x5', xp: 15, needsWeight: true },
                        { name: 'Facepulls - 3x15', xp: 10 }
                    ]},
                    'Montag': { ...baseWorkout.Montag, exercises: [
                        { name: 'Handstand Shoulder Taps - 3x8', xp: 20 },
                        { name: 'Dips - 5x12-15', xp: 15 },
                        { name: 'Langhantel Overhead Press - 3x7-9', xp: 15, needsWeight: true },
                        { name: 'Tuck Planche Attempts - 4x max', xp: 18 },
                        { name: 'Goblet Squats - 3x15', xp: 12, needsWeight: true },
                        { name: 'Langhantel Curls - 3x12', xp: 10, needsWeight: true }
                    ]},
                    'Mittwoch': { ...baseWorkout.Mittwoch, exercises: [
                        { name: '30 Min Spaziergang/Cardio', xp: 15 },
                        { name: 'Hollow Body to Arch - 3x10', xp: 12 },
                        { name: 'Yoga Flow - 15 Min', xp: 10 },
                        { name: 'Faszienrolle/Stretching', xp: 10 }
                    ]}
                },
                7: {
                    'Montag': { duration: 30, calories: 200, exercises: [{ name: 'Leichtes Mobility-Training', xp: 20 }]},
                    'Dienstag': { duration: 30, calories: 200, exercises: [{ name: 'Spaziergang 30 Min', xp: 20 }]},
                    'Mittwoch': { duration: 45, calories: 200, exercises: [
                        { name: 'Yoga Flow - 30 Min', xp: 20 },
                        { name: 'Faszienrolle - 15 Min', xp: 10 }
                    ]},
                    'Donnerstag': { duration: 30, calories: 200, exercises: [{ name: 'Schwimmen oder Radfahren - 30 Min', xp: 20 }]},
                    'Freitag': { duration: 30, calories: 150, exercises: [{ name: 'Stretching & Meditation', xp: 20 }]},
                    'Samstag': { duration: 0, calories: 0, exercises: [{ name: 'Vollst√§ndige Ruhe', xp: 0 }]},
                    'Sonntag': { duration: 0, calories: 0, exercises: [{ name: 'Vollst√§ndige Ruhe', xp: 0 }]}
                }
            };

            const getCurrentWorkout = (week) => {
                if (workoutProgression[week]) return workoutProgression[week];
                if (week <= 6) return workoutProgression[6];
                if (week === 7) return workoutProgression[7];
                return baseWorkout;
            };

            const [workoutPlan, setWorkoutPlan] = useState(() => getCurrentWorkout(currentWeek));
            const [completedExercises, setCompletedExercises] = useState(() => JSON.parse(localStorage.getItem('completedExercises') || '{}'));
            const [sessions, setSessions] = useState(() => JSON.parse(localStorage.getItem('sessions') || '[]'));
            const [progressData, setProgressData] = useState(() => JSON.parse(localStorage.getItem('progressData') || '[]'));
            const [weightTracking, setWeightTracking] = useState(() => JSON.parse(localStorage.getItem('weightTracking') || '{}'));
            const [showWeightModal, setShowWeightModal] = useState(false);
            const [currentExercise, setCurrentExercise] = useState(null);

            const getCycleInfo = (week) => {
                if (week <= 6) return { name: 'Zyklus 1: Foundation', color: 'blue', phase: 'cycle1' };
                if (week === 7) return { name: 'Deload-Woche', color: 'green', phase: 'deload1' };
                if (week <= 13) return { name: 'Zyklus 2: Skill Development', color: 'purple', phase: 'cycle2' };
                if (week === 14) return { name: 'Deload-Woche', color: 'green', phase: 'deload2' };
                if (week <= 20) return { name: 'Zyklus 3: Advanced Skills', color: 'orange', phase: 'cycle3' };
                return { name: 'Wartungsmodus', color: 'gray', phase: 'maintenance' };
            };

            const getExerciseKey = (name) => Object.keys(weightTracking).find(k => name.includes(k)) || name;

            const getWeightRecommendation = (key) => {
                const hist = weightTracking[key];
                if (!hist || !hist.length) return null;
                const last = hist[hist.length - 1];
                const done = last.sets.every(s => s.reps >= (last.targetReps || 8));
                return done ? { weight: last.weight + 2.5, message: 'Gewicht erh√∂hen!' } : { weight: last.weight, message: 'Gleiches Gewicht' };
            };

            const getWeightRecommendationDisplay = (ex) => {
                const key = getExerciseKey(ex.name);
                if (!key || !weightTracking[key]) return null;
                const rec = getWeightRecommendation(key);
                return rec ? <div className="text-xs text-blue-400 mt-1">{rec.weight}kg empfohlen</div> : null;
            };

            useEffect(() => { localStorage.setItem('userLevel', userLevel); }, [userLevel]);
            useEffect(() => { localStorage.setItem('xp', xp); }, [xp]);
            useEffect(() => { localStorage.setItem('currentWeek', currentWeek); }, [currentWeek]);
            useEffect(() => { localStorage.setItem('completedExercises', JSON.stringify(completedExercises)); }, [completedExercises]);
            useEffect(() => { localStorage.setItem('sessions', JSON.stringify(sessions)); }, [sessions]);
            useEffect(() => { localStorage.setItem('progressData', JSON.stringify(progressData)); }, [progressData]);
            useEffect(() => { localStorage.setItem('weightTracking', JSON.stringify(weightTracking)); }, [weightTracking]);
            useEffect(() => { localStorage.setItem('skillGoals', JSON.stringify(skillGoals)); }, [skillGoals]);

            useEffect(() => {
                let int;
                if (isTimerRunning) int = setInterval(() => setTimerSeconds(p => p + 1), 1000);
                return () => clearInterval(int);
            }, [isTimerRunning]);

            const formatTime = (s) => {
                const h = Math.floor(s / 3600), m = Math.floor((s % 3600) / 60), sec = s % 60;
                return `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
            };

            const changeWeek = (newWeek) => {
                const validWeek = Math.max(1, Math.min(20, newWeek));
                setCurrentWeek(validWeek);
                setWorkoutPlan(getCurrentWorkout(validWeek));
            };

            const toggleExercise = (day, ex) => {
                if (ex.needsWeight) {
                    setCurrentExercise({ day, exercise: ex });
                    setShowWeightModal(true);
                    return;
                }
                const key = day + '-' + ex.name;
                const done = completedExercises[key];
                const newComp = { ...completedExercises };
                newComp[key] = !done;
                setCompletedExercises(newComp);
                
                if (!done && ex.xp) {
                    const newXP = xp + ex.xp;
                    if (newXP >= xpNeeded * 100) {
                        setUserLevel(p => p + 1);
                        setXp(newXP - (xpNeeded * 100));
                    } else setXp(newXP);
                } else if (done && ex.xp) setXp(p => Math.max(0, p - ex.xp));
            };

            const saveWeightEntry = () => {
                const w = parseFloat(document.getElementById('weightInput').value);
                const sets = parseInt(document.getElementById('setsInput').value);
                const reps = document.getElementById('repsInput').value;
                if (!w || !sets || !reps) return;

                const key = getExerciseKey(currentExercise.exercise.name);
                const repsArr = reps.split(',').map(r => parseInt(r.trim()));
                const entry = { date: new Date().toISOString().split('T')[0], weight: w, sets: repsArr.map(r => ({reps: r})), targetReps: Math.max(...repsArr) };

                const newTrack = { ...weightTracking };
                if (!newTrack[key]) newTrack[key] = [];
                newTrack[key].push(entry);
                setWeightTracking(newTrack);

                const exKey = currentExercise.day + '-' + currentExercise.exercise.name;
                const newComp = { ...completedExercises };
                newComp[exKey] = true;
                setCompletedExercises(newComp);

                if (currentExercise.exercise.xp) {
                    const newXP = xp + currentExercise.exercise.xp;
                    if (newXP >= xpNeeded * 100) {
                        setUserLevel(p => p + 1);
                        setXp(newXP - (xpNeeded * 100));
                    } else setXp(newXP);
                }

                setShowWeightModal(false);
                setCurrentExercise(null);
            };

            const updateSkillGoal = (skill, value) => {
                const newGoals = { ...skillGoals };
                newGoals[skill].current = parseFloat(value);
                if (value > newGoals[skill].milestone) {
                    newGoals[skill].milestone = parseFloat(value);
                    const bonusXP = 100;
                    const newXP = xp + bonusXP;
                    if (newXP >= xpNeeded * 100) {
                        setUserLevel(p => p + 1);
                        setXp(newXP - (xpNeeded * 100));
                    } else setXp(newXP);
                }
                setSkillGoals(newGoals);
            };

            const getLevelTitle = (l) => {
                if (l < 4) return "Novice";
                if (l < 8) return "Beginner";
                if (l < 12) return "Intermediate";
                if (l < 20) return "Advanced";
                if (l < 30) return "Elite";
                return "Master";
            };

            const CircularProgress = ({ percentage }) => {
                const r = 70, c = 2 * Math.PI * r, o = c - (percentage / 100) * c;
                return (
                    <svg width="180" height="180" className="transform -rotate-90">
                        <circle cx="90" cy="90" r={r} stroke="#1e293b" strokeWidth="12" fill="none" />
                        <circle cx="90" cy="90" r={r} stroke="url(#gradient)" strokeWidth="12" fill="none" strokeDasharray={c} strokeDashoffset={o} strokeLinecap="round" className="transition-all duration-500" />
                        <defs><linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stopColor="#3b82f6" /><stop offset="100%" stopColor="#8b5cf6" /></linearGradient></defs>
                    </svg>
                );
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white p-4">
                    <div className="max-w-4xl mx-auto">
                        <div className="flex gap-2 mb-6 bg-slate-800 p-1 rounded-lg overflow-x-auto">
                            <button onClick={() => setActiveTab('home')} className={'flex-1 py-3 px-4 rounded-md transition-all whitespace-nowrap ' + (activeTab === 'home' ? 'bg-blue-600' : 'hover:bg-slate-700')}>
                                <Trophy className="w-5 h-5 inline mr-2" />Home
                            </button>
                            <button onClick={() => setActiveTab('goals')} className={'flex-1 py-3 px-4 rounded-md transition-all whitespace-nowrap ' + (activeTab === 'goals' ? 'bg-purple-600' : 'hover:bg-slate-700')}>
                                <Target className="w-5 h-5 inline mr-2" />Ziele
                            </button>
                            <button onClick={() => setActiveTab('workout')} className={'flex-1 py-3 px-4 rounded-md transition-all whitespace-nowrap ' + (activeTab === 'workout' ? 'bg-blue-600' : 'hover:bg-slate-700')}>
                                <Calendar className="w-5 h-5 inline mr-2" />Workout
                            </button>
                            <button onClick={() => setActiveTab('timer')} className={'flex-1 py-3 px-4 rounded-md transition-all whitespace-nowrap ' + (activeTab === 'timer' ? 'bg-blue-600' : 'hover:bg-slate-700')}>
                                <Play className="w-5 h-5 inline mr-2" />Timer
                            </button>
                            <button onClick={() => setActiveTab('progress')} className={'flex-1 py-3 px-4 rounded-md transition-all whitespace-nowrap ' + (activeTab === 'progress' ? 'bg-blue-600' : 'hover:bg-slate-700')}>
                                <TrendingUp className="w-5 h-5 inline mr-2" />Stats
                            </button>
                        </div>

                        {activeTab === 'home' && (
                            <div className="space-y-6">
                                <div className="bg-gradient-to-br from-slate-800 to-slate-700 rounded-lg p-8 text-center shadow-2xl">
                                    <div className="flex justify-center mb-6">
                                        <div className="relative">
                                            <CircularProgress percentage={(xp / (xpNeeded * 100)) * 100} />
                                            <div className="absolute inset-0 flex items-center justify-center">
                                                <div className="text-center">
                                                    <div className="text-5xl font-bold text-blue-400">{userLevel}</div>
                                                    <div className="text-xs text-slate-400 mt-1">LEVEL</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <h2 className="text-2xl font-bold mb-2">{getLevelTitle(userLevel)}</h2>
                                    <p className="text-slate-400 mb-4">{xp} / {xpNeeded * 100} XP</p>
                                    <div className="w-full bg-slate-700 rounded-full h-3 mb-2">
                                        <div className="bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500" style={{ width: ((xp / (xpNeeded * 100)) * 100) + '%' }}></div>
                                    </div>
                                    <p className="text-sm text-slate-400">Noch {(xpNeeded * 100) - xp} XP bis Level {userLevel + 1}</p>
                                </div>

                                <div className={'bg-slate-800 rounded-lg p-5 shadow-lg border-2 border-' + getCycleInfo(currentWeek).color + '-500'}>
                                    <div className="flex justify-between items-center mb-4">
                                        <div>
                                            <h3 className="text-xl font-bold">Woche {currentWeek}</h3>
                                            <p className={'text-sm text-' + getCycleInfo(currentWeek).color + '-400'}>{getCycleInfo(currentWeek).name}</p>
                                        </div>
                                        <div className="flex gap-2">
                                            <button onClick={() => changeWeek(currentWeek - 1)} disabled={currentWeek === 1} className="px-3 py-1 bg-slate-700 rounded hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed">‚Üê</button>
                                            <button onClick={() => changeWeek(currentWeek + 1)} disabled={currentWeek === 20} className="px-3 py-1 bg-slate-700 rounded hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed">‚Üí</button>
                                        </div>
                                    </div>
                                    {currentWeek === 7 && (
                                        <div className="mb-4 p-3 bg-green-900/30 border border-green-700 rounded">
                                            <p className="text-sm text-green-300">Regenerationswoche - Dein K√∂rper braucht Erholung! Nur leichte Aktivit√§ten.</p>
                                        </div>
                                    )}
                                    {currentWeek === 6 && (
                                        <div className="mb-4 p-3 bg-blue-900/30 border border-blue-700 rounded">
                                            <p className="text-sm text-blue-300">Letzte Woche des Zyklus! N√§chste Woche ist Deload.</p>
                                        </div>
                                    )}
                                </div>

                                <div className="grid grid-cols-2 gap-4">
                                    <div className="bg-slate-800 rounded-lg p-5 text-center">
                                        <Zap className="w-8 h-8 mx-auto mb-2 text-yellow-400" />
                                        <div className="text-2xl font-bold">{Object.values(completedExercises).filter(Boolean).length}</div>
                                        <div className="text-sm text-slate-400">√úbungen erledigt</div>
                                    </div>
                                    <div className="bg-slate-800 rounded-lg p-5 text-center">
                                        <Target className="w-8 h-8 mx-auto mb-2 text-green-400" />
                                        <div className="text-2xl font-bold">{sessions.length}</div>
                                        <div className="text-sm text-slate-400">Sessions</div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'goals' && (
                            <div className="space-y-4">
                                <div className="bg-slate-800 rounded-lg p-5 shadow-lg">
                                    <h3 className="text-xl font-bold mb-4">Deine 6 gro√üen Ziele</h3>
                                    <p className="text-sm text-slate-400 mb-4">Langzeit-Ziele √ºber 12-18 Monate. Aktualisiere deine Fortschritte regelm√§√üig!</p>
                                </div>
                                {Object.entries(skillGoals).map(([skill, data]) => (
                                    <div key={skill} className="bg-slate-800 rounded-lg p-5 shadow-lg">
                                        <div className="flex justify-between items-start mb-3">
                                            <div>
                                                <h4 className="text-lg font-bold text-blue-400">{skill}</h4>
                                                <p className="text-sm text-slate-400">Ziel: {data.target} {data.unit}</p>
                                            </div>
                                            <div className="text-right">
                                                <div className="text-2xl font-bold">{data.current}</div>
                                                <div className="text-xs text-slate-400">{data.unit}</div>
                                            </div>
                                        </div>
                                        <div className="w-full bg-slate-700 rounded-full h-3 mb-3">
                                            <div className="bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all" style={{ width: ((data.current / data.target) * 100) + '%' }}></div>
                                        </div>
                                        <div className="flex gap-2">
                                            <input type="number" step="0.5" placeholder="Neuer Wert" id={'skill-' + skill} className="flex-1 px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500 text-sm" />
                                            <button onClick={() => {
                                                const val = document.getElementById('skill-' + skill).value;
                                                if (val) {
                                                    updateSkillGoal(skill, val);
                                                    document.getElementById('skill-' + skill).value = '';
                                                }
                                            }} className="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm transition-all">Update</button>
                                        </div>
                                        {data.milestone > 0 && (
                                            <p className="text-xs text-green-400 mt-2">Bester Wert: {data.milestone} {data.unit}</p>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeTab === 'workout' && (
                            <div className="space-y-4">
                                <div className={'bg-slate-800 rounded-lg p-4 mb-4 border-2 border-' + getCycleInfo(currentWeek).color + '-500'}>
                                    <div className="flex justify-between items-center">
                                        <div>
                                            <h2 className="text-xl font-bold">Woche {currentWeek}</h2>
                                            <p className={'text-sm text-' + getCycleInfo(currentWeek).color + '-400'}>{getCycleInfo(currentWeek).name}</p>
                                        </div>
                                        <div className="flex gap-2">
                                            <button onClick={() => changeWeek(currentWeek - 1)} disabled={currentWeek === 1} className="px-3 py-1 bg-slate-700 rounded hover:bg-slate-600 disabled:opacity-50">‚Üê</button>
                                            <button onClick={() => changeWeek(currentWeek + 1)} disabled={currentWeek === 20} className="px-3 py-1 bg-slate-700 rounded hover:bg-slate-600 disabled:opacity-50">‚Üí</button>
                                        </div>
                                    </div>
                                </div>

                                {Object.entries(workoutPlan).map(([day, plan]) => (
                                    <div key={day} className="bg-slate-800 rounded-lg p-5 shadow-lg">
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-xl font-bold text-blue-400">{day}</h3>
                                            <div className="text-right">
                                                <span className="text-slate-400 text-sm">{plan.duration} Min</span>
                                                {plan.calories > 0 && <span className="text-slate-400 text-sm"> | ~{plan.calories} kcal</span>}
                                            </div>
                                        </div>
                                        <div className="space-y-2">
                                            {plan.exercises.map((ex, i) => {
                                                const key = day + '-' + ex.name + '-week' + currentWeek;
                                                const done = completedExercises[key];
                                                return (
                                                    <div key={i} onClick={() => toggleExercise(day, ex)} className={'flex items-center gap-3 p-3 rounded cursor-pointer transition-all ' + (done ? 'bg-green-900/30 line-through text-slate-400' : 'bg-slate-700 hover:bg-slate-600')}>
                                                        {done ? <CheckCircle className="w-5 h-5 text-green-400 flex-shrink-0" /> : <Circle className="w-5 h-5 text-slate-500 flex-shrink-0" />}
                                                        <div className="flex-1">
                                                            <div>{ex.name}</div>
                                                            {ex.needsWeight && getWeightRecommendationDisplay(ex)}
                                                        </div>
                                                        {ex.xp > 0 && <span className="text-xs text-yellow-400 bg-yellow-900/30 px-2 py-1 rounded">+{ex.xp} XP</span>}
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeTab === 'timer' && (
                            <div className="space-y-6">
                                <div className="bg-slate-800 rounded-lg p-8 text-center shadow-lg">
                                    <div className="text-6xl font-mono font-bold mb-6 text-blue-400">{formatTime(timerSeconds)}</div>
                                    <div className="flex gap-4 justify-center mb-6">
                                        <button onClick={() => setIsTimerRunning(!isTimerRunning)} className="px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center gap-2 transition-all">
                                            {isTimerRunning ? <Pause className="w-5 h-5" /> : <Play className="w-5 h-5" />}
                                            {isTimerRunning ? 'Pause' : 'Start'}
                                        </button>
                                        <button onClick={() => { setIsTimerRunning(false); setTimerSeconds(0); setSessionCalories(''); }} className="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg flex items-center gap-2 transition-all">
                                            <RotateCcw className="w-5 h-5" />Reset
                                        </button>
                                    </div>
                                    <div className="max-w-xs mx-auto">
                                        <label className="block text-sm text-slate-400 mb-2">Kalorien (optional)</label>
                                        <input type="number" value={sessionCalories} onChange={(e) => setSessionCalories(e.target.value)} placeholder="z.B. 450" className="w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" />
                                    </div>
                                    <button onClick={() => { if (timerSeconds > 0) { setSessions([{date: new Date().toISOString().split('T')[0], duration: timerSeconds, calories: parseInt(sessionCalories) || 0, week: currentWeek}, ...sessions]); setIsTimerRunning(false); setTimerSeconds(0); setSessionCalories(''); }}} disabled={timerSeconds === 0} className="mt-6 px-8 py-3 bg-green-600 hover:bg-green-700 disabled:bg-slate-700 disabled:cursor-not-allowed rounded-lg transition-all">
                                        Session beenden
                                    </button>
                                </div>
                                <div className="bg-slate-800 rounded-lg p-5 shadow-lg">
                                    <h3 className="text-xl font-bold mb-4">Letzte Sessions</h3>
                                    {sessions.length === 0 ? (
                                        <p className="text-slate-400 text-center py-4">Noch keine Sessions</p>
                                    ) : (
                                        <div className="space-y-2">
                                            {sessions.slice(0, 5).map((s, i) => (
                                                <div key={i} className="flex justify-between items-center p-3 bg-slate-700 rounded">
                                                    <div>
                                                        <div className="font-medium">{s.date}</div>
                                                        <div className="text-sm text-slate-400">Woche {s.week}</div>
                                                    </div>
                                                    <div className="text-right">
                                                        <div className="text-blue-400">{formatTime(s.duration)}</div>
                                                        {s.calories > 0 && <div className="text-sm text-slate-400">{s.calories} kcal</div>}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {activeTab === 'progress' && (
                            <div className="space-y-6">
                                <div className="bg-slate-800 rounded-lg p-5 shadow-lg">
                                    <h3 className="text-xl font-bold mb-4">Messungen eintragen</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                                        <input type="date" id="progressDate" defaultValue={new Date().toISOString().split('T')[0]} className="px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" />
                                        <input type="text" id="progressExercise" placeholder="√úbung" className="px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" />
                                        <input type="text" id="progressValue" placeholder="Wert" className="px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" />
                                    </div>
                                    <button onClick={() => { const d = document.getElementById('progressDate').value, ex = document.getElementById('progressExercise').value, v = document.getElementById('progressValue').value; if (d && ex && v) { setProgressData([...progressData, {date: d, exercise: ex, value: v}]); document.getElementById('progressExercise').value = ''; document.getElementById('progressValue').value = ''; }}} className="w-full mt-3 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all">
                                        Hinzuf√ºgen
                                    </button>
                                </div>
                                <div className="bg-slate-800 rounded-lg p-5 shadow-lg">
                                    <h3 className="text-xl font-bold mb-4">Verlauf</h3>
                                    {progressData.length === 0 ? (
                                        <p className="text-slate-400 text-center py-4">Noch keine Messungen</p>
                                    ) : (
                                        <div className="space-y-2 max-h-96 overflow-y-auto">
                                            {[...progressData].reverse().map((e, i) => (
                                                <div key={i} className="flex justify-between items-center p-3 bg-slate-700 rounded">
                                                    <div>
                                                        <div className="font-medium">{e.exercise}</div>
                                                        <div className="text-sm text-slate-400">{e.date}</div>
                                                    </div>
                                                    <div className="text-blue-400 font-bold">{e.value}</div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}
                    </div>

                    {showWeightModal && currentExercise && (
                        <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4" onClick={() => setShowWeightModal(false)}>
                            <div className="bg-slate-800 rounded-lg p-6 max-w-md w-full" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold text-blue-400">{currentExercise.exercise.name}</h3>
                                    <button onClick={() => setShowWeightModal(false)} className="text-slate-400 hover:text-white">
                                        <X className="w-6 h-6" />
                                    </button>
                                </div>

                                {(() => {
                                    const key = getExerciseKey(currentExercise.exercise.name);
                                    const rec = getWeightRecommendation(key);
                                    return rec ? (
                                        <div className="mb-4 p-3 bg-blue-900/30 border border-blue-700 rounded">
                                            <div className="text-sm font-medium text-blue-300">{rec.message}</div>
                                            <div className="text-lg font-bold text-blue-400">{rec.weight} kg</div>
                                        </div>
                                    ) : null;
                                })()}

                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm text-slate-400 mb-2">Gewicht (kg)</label>
                                        <input type="number" id="weightInput" step="0.5" placeholder="z.B. 60" className="w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" />
                                    </div>
                                    <div>
                                        <label className="block text-sm text-slate-400 mb-2">Anzahl S√§tze</label>
                                        <input type="number" id="setsInput" placeholder="z.B. 4" className="w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" />
                                    </div>
                                    <div>
                                        <label className="block text-sm text-slate-400 mb-2">Wiederholungen pro Satz (kommagetrennt)</label>
                                        <input type="text" id="repsInput" placeholder="z.B. 8,8,7,6" className="w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-500" />
                                        <p className="text-xs text-slate-500 mt-1">Trage die Wiederholungen f√ºr jeden Satz ein</p>
                                    </div>
                                </div>

                                {(() => {
                                    const key = getExerciseKey(currentExercise.exercise.name);
                                    const hist = weightTracking[key];
                                    return hist && hist.length > 0 ? (
                                        <div className="mt-4 p-3 bg-slate-700 rounded">
                                            <div className="text-sm font-medium text-slate-300 mb-2">Letzter Eintrag:</div>
                                            <div className="text-sm text-slate-400">{hist[hist.length - 1].date} - {hist[hist.length - 1].weight}kg</div>
                                            <div className="text-xs text-slate-500">{hist[hist.length - 1].sets.map(s => s.reps).join(', ')} Wdh.</div>
                                        </div>
                                    ) : null;
                                })()}

                                <div className="flex gap-3 mt-6">
                                    <button onClick={() => setShowWeightModal(false)} className="flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-all">Abbrechen</button>
                                    <button onClick={saveWeightEntry} className="flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all">Speichern</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FitnessTracker />);
    </script>
</body>
</html>
